if (self.CavalryLogger) { CavalryLogger.start_js(["alxUa"]); }

__d('MessengerThreadlistRow.react',['cx','fbt','ix','Bootloader','FBRTCCore','Image.react','immutable','ImmutableObject','Link.react','mercuryBlockedParticipantsRe','MercuryIDs','MercuryMessageInfo','MercuryThreadActions','MercuryThreadSnippet.react','mercuryThreadTimestampReact','MercuryThreadTitle.react','MercuryTimestamp','MessagingTag','MessengerAdminGroupUtils','messengerButtonReact','messengerDialogsRe','MessengerPresenceStatusUtils','MessengerMessageRequestsTypedLogger','messengerThreadImageReact','messengerThreadlistRowActionsReact','messengerThreadlistRowSeenHeadReact','messengerURIUtilsRe','MNAdsMessageUtils','React','ReactDOM','RTCConfig','FBRTCLogger','UserAgent','getPageIDFromThreadID','joinClasses','messengerRTLClasses'],(function a(b,c,d,e,f,g,h,i,j){'use strict';var k,l,m=c('mercuryBlockedParticipantsRe').get(),n=c('mercuryThreadTimestampReact').jsComponent,o=c('messengerButtonReact').jsComponent,p=c('messengerThreadImageReact').jsComponent,q=c('messengerThreadlistRowActionsReact').jsComponent,r=c('messengerThreadlistRowSeenHeadReact').jsComponent,s=c('FBRTCLogger').Trigger,t=c('React').PropTypes,u=50,v=j("86913"),w=j("86914");k=babelHelpers.inherits(x,c('React').PureComponent);l=k&&k.prototype;function x(){var y,z;for(var aa=arguments.length,ba=Array(aa),ca=0;ca<aa;ca++)ba[ca]=arguments[ca];return z=(y=l.constructor).call.apply(y,[this].concat(ba)),this.state={actionsOpen:false},this.$MessengerThreadlistRow1=0,this.$MessengerThreadlistRow2=null,this.$MessengerThreadlistRow17=function(){c('MercuryThreadActions').get()['delete'](this.props.thread.thread_id);new (c('MessengerMessageRequestsTypedLogger'))().setAction('message_requests_delete_request').setThreadID(c('MercuryIDs').getThreadFBIDFromThreadID(this.props.thread.thread_id)).setSurface('inbox').setFolderType('pending').setThreadKeyWeb(this.props.thread.thread_id).setEntryPoint('inbox_banner').log();}.bind(this),this.$MessengerThreadlistRow16=function(){c('MercuryThreadActions').get().archive(this.props.thread.thread_id);}.bind(this),this.$MessengerThreadlistRow18=function(da){if(!da){c('messengerDialogsRe').removeDialog();new (c('MessengerMessageRequestsTypedLogger'))().setAction('message_requests_decline_cancel').setThreadID(c('MercuryIDs').getThreadFBIDFromThreadID(this.props.thread.thread_id)).setSurface('inbox').setFolderType('pending').setThreadKeyWeb(this.props.thread.thread_id).setEntryPoint('inbox_banner').log();}}.bind(this),this.$MessengerThreadlistRow4=function(da){da.preventDefault();this.props.onFocus(this.props.thread.thread_id);}.bind(this),this.$MessengerThreadlistRow5=function(da){this.$MessengerThreadlistRow1++;if(this.$MessengerThreadlistRow2)return;this.$MessengerThreadlistRow2=setTimeout(function(){this.props.onSelect&&this.props.onSelect();this.$MessengerThreadlistRow1=0;this.$MessengerThreadlistRow2=null;}.bind(this),1000);}.bind(this),this.$MessengerThreadlistRow6=function(da){this.$MessengerThreadlistRow1--;if(this.$MessengerThreadlistRow1===0){clearTimeout(this.$MessengerThreadlistRow2);this.$MessengerThreadlistRow2=null;}}.bind(this),this.$MessengerThreadlistRow8=function(da){if(this.props.logClickHandler){var ea=this.props.thread.is_canonical?c('MercuryIDs').getUserIDFromThreadID(this.props.thread.thread_id)||'0':this.props.thread.thread_fbid;this.props.logClickHandler&&this.props.logClickHandler(ea);}this.$MessengerThreadlistRow9();this.props.onSelect&&this.props.onSelect();da.preventDefault();this.$MessengerThreadlistRow3();}.bind(this),this.$MessengerThreadlistRow15=function(da){this.setState({actionsOpen:da});}.bind(this),this.$MessengerThreadlistRow19=function(da){da.preventDefault();da.stopPropagation();var ea=this.props.thread,fa=ea.rtc_call_data,ga=ea.thread_fbid;c('FBRTCCore').startGroupCall({conferenceName:'GROUP:'+ga,hasVideo:true,serverInfoData:fa.server_info_data,trigger:s.MULTIWAY_THREAD_LIST_JOIN_CALL_BUTTON});}.bind(this),this.$MessengerThreadlistRow3=function(){var da=c('ReactDOM').findDOMNode(this.refs.link);if(da.href){da.setAttribute('data-href',da.href);da.removeAttribute('href');}}.bind(this),this.$MessengerThreadlistRow9=function(){var da=c('ReactDOM').findDOMNode(this.refs.link),ea=da.getAttribute('data-href');if(ea){da.setAttribute('href',ea);da.removeAttribute('data-href');}}.bind(this),z;}x.prototype.componentDidMount=function(){this.$MessengerThreadlistRow3();};x.prototype.componentDidUpdate=function(y){if(this.props.isFocused)if(!y.isFocused){if(this.props.isActionsFocused){c('ReactDOM').findDOMNode(this.refs.actions.refs.button).focus();}else c('ReactDOM').findDOMNode(this.refs.link).focus();}else if(!y.isActionsFocused&&this.props.isActionsFocused){c('ReactDOM').findDOMNode(this.refs.actions.refs.button).focus();}else if(y.isActionsFocused&&!this.props.isActionsFocused)c('ReactDOM').findDOMNode(this.refs.link).focus();};x.prototype.render=function(){var y=this.props,z=y.isActive,aa=y.isActionsFocused,ba=y.isTabbable,ca=y.participants,da=y.thread,ea=y.viewer,fa=da.unread_count>0,ga=c('messengerURIUtilsRe').getURIForThreadID(da.thread_id);return c('React').createElement('li',{'aria-live':fa?'polite':null,'aria-relevant':z||fa?'additions text':null,onFocus:this.$MessengerThreadlistRow4,className:"_5l-3"+(' '+"_1ht1")+(da.folder===c('MessagingTag').PENDING?' '+"_4as3":'')+(this.props.isActive?' '+"_1ht2":'')+(fa?' '+"_1ht3":'')+(this.state.actionsOpen?' '+"_13aa":'')+(this.props.isMuted?' '+"_569x":'')+(this.props.isFocused?' '+"_23_m":'')+(fa&&c('UserAgent').isBrowser('Chrome')&&c('UserAgent').isPlatform('Mac')?' '+"_5fx8":''),onDragEnter:z?null:this.$MessengerThreadlistRow5,onDragLeave:z?null:this.$MessengerThreadlistRow6,role:'row',ref:function(ha){return ha&&this.props.registerThreadRefs&&this.props.registerThreadRefs(ha);}.bind(this),tabIndex:-1},c('React').createElement('div',{className:"_5l-3 _1ht5",id:this.$MessengerThreadlistRow7(da.thread_id),role:'gridcell',tabIndex:-1},c('React').createElement(c('Link.react'),{href:ga.toString(),onBlur:this.$MessengerThreadlistRow3,onClick:this.$MessengerThreadlistRow8,onFocus:this.$MessengerThreadlistRow9,className:"_1ht5 _2il3 _5l-3",s:'true',ref:'link',role:'link',tabIndex:ba&&!aa?0:-1},c('React').createElement('div',{'aria-hidden':true,className:"_1qt3 _5l-3"},c('React').createElement(p,{participants:ca,size:u,thread:da,viewer:ea})),c('React').createElement('div',{className:"_1qt4 _5l-m"},c('React').createElement('div',{className:"_1qt5 _5l-3"},c('React').createElement(c('MercuryThreadTitle.react'),{className:"_1ht6",showUnreadCount:false,thread:da,useShortName:false,viewer:ea}),c('React').createElement('div',null,c('MNAdsMessageUtils').isAdsMessageRequest(da)?c('MNAdsMessageUtils').renderAdsMessageRequestStatus():this.$MessengerThreadlistRow10(da))),c('React').createElement('div',{className:"_1qt5 _5l-3"},c('React').createElement(c('MercuryThreadSnippet.react'),{className:c('joinClasses')("_1htf",c('messengerRTLClasses')(da.snippet,true)),participants:ca,shouldRenderYou:true,thread:da,viewer:ea})),this.$MessengerThreadlistRow11(),this.$MessengerThreadlistRow12()))),this.$MessengerThreadlistRow13());};x.prototype.$MessengerThreadlistRow13=function(){if(this.props.showActions===false)return null;var y=this.props,z=y.isActionsFocused,aa=y.isTabbable,ba=y.participants,ca=y.thread,da=y.viewer,ea=c('MessengerPresenceStatusUtils').getStatusFromCanonicalThread(this.props.participants,ca),fa=ea&&ea.contact,ga=m.isMessageBlocked(ca),ha=c('MessengerAdminGroupUtils').isJoinableThread(ca),ia=c('MessengerAdminGroupUtils').isGroupChat(ca),ja=ca.unread_count>0;return c('React').createElement('div',{role:'gridcell'},c('React').createElement('div',{'aria-describedby':this.$MessengerThreadlistRow7(ca.thread_id),'aria-haspopup':'true','aria-label':i._("Actions"),className:"_2j6 _5l-3",tabIndex:aa&&z?0:-1,role:'button'},c('React').createElement(r,{className:"_5bli",isHidden:this.state.actionsOpen,lastMessage:this.props.lastMessage,participants:ba,readReceipts:this.props.readReceipts,thread:ca,viewer:da}),this.$MessengerThreadlistRow14(),c('React').createElement(q,{contact:fa,isGroupChat:ia,isJoinableThread:ha,isMuted:this.props.isMuted,isOpen:this.state.actionsOpen,isUnread:ja,isBlocked:ga,onArchive:this.props.onArchive,onDelete:this.props.onDelete,onLeaveGroup:this.props.onLeaveGroup,onMarkRead:this.props.onMarkRead,onMarkSpam:this.props.onMarkSpam,onMarkUnread:this.props.onMarkUnread,onMute:this.props.onMute,onToggle:this.$MessengerThreadlistRow15,onUnmute:this.props.onUnmute,onBlock:this.props.onBlock,onUnblock:this.props.onUnblock,showLeaveGroup:this.props.showLeaveGroup,showMute:true,showBlock:ca.is_canonical_user&&ca.other_user_fbid&&da!==ca.other_user_fbid,showReport:c('getPageIDFromThreadID')(this.props.thread.thread_id),tabIndex:-1,thread:ca,ref:'actions'}),c('React').createElement('div',{className:"_56ck"})));};x.prototype.$MessengerThreadlistRow14=function(){var y=this.props.lastMessage;if(this.state.actionsOpen||!y)return null;var z=c('MercuryMessageInfo').isSending(y),aa=c('MercuryMessageInfo').hasError(y);if(!z&&!aa)return null;return c('React').createElement(c('Image.react'),{className:"_wtw"+(z?' '+"_3qh2":''),src:z?w:v});};x.prototype.$MessengerThreadlistRow10=function(y){return c('React').createElement(n,{className:"_1ht7",time:y.timestamp,title:c('MercuryTimestamp').getAbsoluteTimestamp(y.timestamp),text:c('MercuryTimestamp').getRelativeTimestamp(y.timestamp)});};x.prototype.$MessengerThreadlistRow11=function(){if(this.props.thread.folder!==c('MessagingTag').PENDING)return null;return c('React').createElement('div',{className:"_5l-3"},c('React').createElement(o,{className:"_3yvh",type:'primary',label:i._("Accept"),onClick:function(y){c('MercuryThreadActions').get().changeFolder(this.props.thread.thread_id,c('MessagingTag').INBOX);new (c('MessengerMessageRequestsTypedLogger'))().setAction('message_requests_accept_request').setThreadID(c('MercuryIDs').getThreadFBIDFromThreadID(this.props.thread.thread_id)).setSurface('inbox').setFolderType('pending').setThreadKeyWeb(this.props.thread.thread_id).setEntryPoint('inbox_banner').log();}.bind(this)}),c('React').createElement(o,{className:"_3yvh",type:'faded',label:i._("Decline"),onClick:function(y){y.preventDefault();y.stopPropagation();c('Bootloader').loadModules(["messengerDeleteDialogReact"],function(z){var aa=z.jsComponent;c('messengerDialogsRe').showDialog(function(){return c('React').createElement(aa,{onArchive:this.$MessengerThreadlistRow16,onDelete:this.$MessengerThreadlistRow17,onToggle:this.$MessengerThreadlistRow18});}.bind(this));new (c('MessengerMessageRequestsTypedLogger'))().setAction('message_requests_decline_attempt').setThreadID(c('MercuryIDs').getThreadFBIDFromThreadID(this.props.thread.thread_id)).setSurface('inbox').setFolderType('pending').setThreadKeyWeb(this.props.thread.thread_id).setEntryPoint('inbox_banner').log();}.bind(this),'MessengerThreadlistRow.react');}.bind(this)}));};x.prototype.$MessengerThreadlistRow12=function(){if(!c('RTCConfig').RtcConferencingGK||!this.props.thread.rtc_call_data||this.props.thread.rtc_call_data.call_state==='NO_ONGOING_CALL')return null;return c('React').createElement(o,{className:"_4ry5",label:i._("Join Call"),onClick:this.$MessengerThreadlistRow19,type:'primary'});};x.prototype.$MessengerThreadlistRow7=function(y){return 'row_header_id_'+y;};x.propTypes={isActive:t.bool.isRequired,isActionsFocused:t.bool,isFocused:t.bool,isMuted:t.bool.isRequired,lastMessage:t.instanceOf(c('ImmutableObject')),logClickHandler:t.func,onArchive:t.func.isRequired,onDelete:t.func.isRequired,onMarkRead:t.func.isRequired,onMarkSpam:t.func.isRequired,onMarkUnread:t.func.isRequired,onMute:t.func.isRequired,onSelect:t.func.isRequired,onUnmute:t.func.isRequired,onBlock:t.func.isRequired,onUnblock:t.func.isRequired,participants:t.instanceOf(c('immutable').Map).isRequired,readReceipts:t.instanceOf(c('immutable').OrderedMap).isRequired,registerThreadRefs:t.func,thread:t.instanceOf(c('ImmutableObject')).isRequired,viewer:t.string.isRequired};f.exports=x;}),null);