if (self.CavalryLogger) { CavalryLogger.start_js(["ARSKu"]); }

__d('MessengerReactions.react',['cx','fbt','Bootloader','CurrentUser','MercuryIDs','MercuryParticipants','MessengerEnvironment','MessengerReactionsUtil','MessengerReactionsPrompt.react','MessengerTextWithEmoticons.react','MessengerWebViewReactionsTypedLogger','TooltipData','React','ShimButton.react'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k,l=c('React').PropTypes,m='ALL',n=c('CurrentUser').getID(),o=3,p=9;j=babelHelpers.inherits(q,c('React').Component);k=j&&j.prototype;function q(){var r,s;for(var t=arguments.length,u=Array(t),v=0;v<t;v++)u[v]=arguments[v];return s=(r=k.constructor).call.apply(r,[this].concat(u)),this.$MessengerReactions2=function(){var w=c('MessengerEnvironment').messengerui,x=this.props,y=x.isFromViewer,z=x.message,aa=x.participants,ba=z.reactions;new (c('MessengerWebViewReactionsTypedLogger'))().setEvent('open_details').setMid(z.message_id).setSenderID(z.author).setEmojiGroup(m).setEmojiGroupCount(Object.values(ba).length).log();if(w){c('Bootloader').loadModules(["messengerDialogsRe","messengerReactionsDialogReact"],function(ca,da){var ea=da.jsComponent;ca.showDialog(function(){return c('React').createElement(ea,{isFromViewer:y,participants:aa,message:z});});},'MessengerReactions.react');}else c('Bootloader').loadModules(["ChatReactionsDialog"],function(ca){ca.show(z,aa,y);},'MessengerReactions.react');}.bind(this),s;}q.prototype.render=function(){var r=this.props,s=r.message,t=r.participants,u=r.renderQuickAdd,v=s.reactions;if((!v||!t)&&!u)return null;var w={},x=0,y=false;Object.entries(v||{}).forEach(function(da){var ea=da[0],fa=da[1];if(typeof fa==='string'){if(ea===n)y=true;if(!w[fa])w[fa]=0;w[fa]++;x++;}});var z=Object.keys(w).sort(c('MessengerReactionsUtil').sortFunction).slice(0,o).map(function(da,ea,fa){return c('React').createElement('span',{className:"_4kf5",style:{zIndex:fa.length-ea,marginLeft:ea===0?0:'-4px'},key:da},c('React').createElement(c('MessengerTextWithEmoticons.react'),{customSize:true,renderEmoticons:true,renderEmoji:true,text:da}));}),aa=x>0?c('React').createElement('span',{className:"_4kf5"+(' '+"_4kf6")+(y?' '+"_fy2":'')},x):null,ba=u&&!y?c('React').createElement('div',{className:"_aou _aov"},c('React').createElement('span',{className:"_aow"},c('React').createElement(c('MessengerReactionsPrompt.react'),{message:s,messageIsSelected:true,isQuickAdd:true}))):null,ca=c('TooltipData').propsFor(this.$MessengerReactions1());return c('React').createElement('div',babelHelpers['extends']({},ca,{className:"_4kf7 preview"}),c('React').createElement(c('ShimButton.react'),{className:"_aou",onClick:this.$MessengerReactions2},z,aa),ba);};q.prototype.$MessengerReactions1=function(){var r=this.props.message.reactions,s=this.props.participants;if(!r||!s)return '';var t=Object.keys(r),u=t.reduce(function(y,z){if(y.length>=p)return y;var aa=c('MercuryIDs').getParticipantIDFromUserID(z),ba=s.get(aa)||c('MercuryParticipants').getNow(aa),ca=ba&&ba.name;if(ca)y.push(ca);return y;},[]),v=u.length,w=u.join('\n');if(t.length>v){var x=i._("and {count} other(s)",[i.param('count',t.length-v)]);w+='\n'+x.toString();}return w;};q.propTypes={isFromViewer:l.bool.isRequired,message:l.object.isRequired,participants:l.object,renderQuickAdd:l.bool};f.exports=q;}),null);